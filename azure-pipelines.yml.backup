trigger:
  - main

variables:
  - group: aws-cloud-project-2025  

stages:
  - stage: VerifyAWSConnection
    displayName: 'Verify AWS CLI Connection'
    jobs:
      - job: Verify
        displayName: 'Verify AWS Access'
        steps:
          # AWS CLI installation        
          - script: |
              echo "Installing or updating AWS CLI"
              curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
              unzip awscliv2.zip
              sudo ./aws/install --update  
            displayName: 'Install or Update AWS CLI'              
          
          # Verifying AWS CLI access
          - script: |
              echo "Verifying AWS CLI Access"
              aws sts get-caller-identity --output text
            displayName: 'Run AWS CLI Command'

